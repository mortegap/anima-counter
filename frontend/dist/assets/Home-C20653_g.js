import{j as N,u as f,k as h,h as z,l as A,_ as T,c as p,a as n,b as L,t as d,e as j,o as m,d as b,v as y,n as F,m as R,w as H,F as U,p as P,q,f as C,r as Z,s as O,i as W}from"./index-DEMo9xAu.js";const $=N("gameState",{state:()=>({turn_number:0,zeon:0,rzeon:0,act:0,rzeoni:0,zeona:0,zeonp:0,acu:!1,lock:0,zeonToSpend:0,mantainZeonToSpend:0,spellBook:[],readyToCast:[],spellMantainList:[],loading:!1,error:null}),getters:{totalZeonAccumulated:o=>o.zeona+o.zeonp,availableZeon:o=>o.zeon+o.zeona+o.zeonp-o.zeonToSpend-o.mantainZeonToSpend,totalReadyToCast:o=>o.readyToCast.length,totalMantained:o=>o.spellMantainList.length},actions:{async loadGameData(){var e,l,t;const o=f();if(!((e=o.profile)!=null&&e.id)){console.error("No hay perfil cargado");return}try{this.loading=!0,this.error=null;const c=await h.get(`/api/gamestate/${o.profile.id}`);this.updateLocalGameState(c.data);const S=await h.get(`/api/spells/${o.profile.id}`);this.spellBook=S.data;const a=await h.get(`/api/ready-to-cast/${o.profile.id}`);this.readyToCast=a.data,this.updateZeonToSpend();const v=await h.get(`/api/spell-mantain/${o.profile.id}`);this.spellMantainList=v.data,this.updateMantainZeonToSpend()}catch(c){console.error("Error cargando datos del juego:",c),this.error=((t=(l=c.response)==null?void 0:l.data)==null?void 0:t.error)||"Error al cargar los datos del juego"}finally{this.loading=!1}},updateLocalGameState(o){this.turn_number=o.turn_number??0,this.zeon=o.zeon??0,this.rzeon=o.rzeon??0,this.act=o.act??0,this.rzeoni=o.rzeoni??0,this.zeona=o.zeona??0,this.zeonp=o.zeonp??0,this.acu=o.acu??!1,this.lock=o.lock_state??0,this.zeonToSpend=o.zeon_to_spend??0,this.mantainZeonToSpend=o.mantain_zeon_to_spend??0},async saveGameState(){var e,l,t;const o=f();if((e=o.profile)!=null&&e.id)try{await h.put(`/api/gamestate/${o.profile.id}`,{turn_number:this.turn_number,zeon:this.zeon,rzeon:this.rzeon,act:this.act,rzeoni:this.rzeoni,zeona:this.zeona,zeonp:this.zeonp,acu:this.acu,lock_state:this.lock,zeon_to_spend:this.zeonToSpend,mantain_zeon_to_spend:this.mantainZeonToSpend})}catch(c){console.error("Error guardando estado del juego:",c),this.error=((t=(l=c.response)==null?void 0:l.data)==null?void 0:t.error)||"Error al guardar el estado"}},async nextTurn(){this.turn_number++,this.rzeoni>0&&(this.zeon=Math.min(this.zeon+this.rzeoni,this.rzeon)),await this.saveGameState()},async previousTurn(){this.turn_number>0&&(this.turn_number--,this.rzeoni>0&&(this.zeon=Math.max(this.zeon-this.rzeoni,0)),await this.saveGameState())},updateZeonToSpend(){this.zeonToSpend=this.readyToCast.reduce((o,e)=>o+(e.zeon_cost||0),0)},updateMantainZeonToSpend(){this.mantainZeonToSpend=this.spellMantainList.reduce((o,e)=>o+(e.mantain_cost||0),0)},async addZeonAccumulated(o,e="normal"){e==="normal"?this.zeona+=o:this.zeonp+=o,await this.saveGameState()},async spendZeon(o){this.zeon=Math.max(0,this.zeon-o),await this.saveGameState()},async addZeon(o){this.zeon=Math.min(this.zeon+o,this.rzeon),await this.saveGameState()},async updateCharacteristics(o){Object.assign(this,o),await this.saveGameState()},async addSpell(o){const e=f();try{const l=await h.post(`/api/spells/${e.profile.id}`,o);this.spellBook.push(l.data)}catch(l){throw console.error("Error añadiendo hechizo:",l),l}},async deleteSpell(o){const e=f();try{await h.delete(`/api/spells/${e.profile.id}/${o}`),this.spellBook=this.spellBook.filter(l=>l.id!==o)}catch(l){throw console.error("Error eliminando hechizo:",l),l}},async addToReadyToCast(o){const e=f();try{const l=await h.post(`/api/ready-to-cast/${e.profile.id}`,{spell_id:o.id,zeon_cost:o.zeon_cost});this.readyToCast.push(l.data),this.updateZeonToSpend()}catch(l){throw console.error("Error añadiendo hechizo a lanzar:",l),l}},async removeFromReadyToCast(o){const e=f();try{await h.delete(`/api/ready-to-cast/${e.profile.id}/${o}`),this.readyToCast=this.readyToCast.filter(l=>l.id!==o),this.updateZeonToSpend()}catch(l){throw console.error("Error eliminando hechizo a lanzar:",l),l}},async addToMantain(o){const e=f();try{const l=await h.post(`/api/spell-mantain/${e.profile.id}`,{spell_id:o.id,mantain_cost:o.mantain_cost});this.spellMantainList.push(l.data),this.updateMantainZeonToSpend()}catch(l){throw console.error("Error añadiendo hechizo a mantener:",l),l}},async removeFromMantain(o){const e=f();try{await h.delete(`/api/spell-mantain/${e.profile.id}/${o}`),this.spellMantainList=this.spellMantainList.filter(l=>l.id!==o),this.updateMantainZeonToSpend()}catch(l){throw console.error("Error eliminando hechizo mantenido:",l),l}},async clearAllReadyToCast(){const o=f();try{await h.delete(`/api/ready-to-cast/${o.profile.id}`),this.readyToCast=[],this.updateZeonToSpend()}catch(e){throw console.error("Error limpiando hechizos a lanzar:",e),e}},async clearAllMantain(){const o=f();try{await h.delete(`/api/spell-mantain/${o.profile.id}`),this.spellMantainList=[],this.updateMantainZeonToSpend()}catch(e){throw console.error("Error limpiando hechizos mantenidos:",e),e}},resetState(){this.turn_number=0,this.zeon=0,this.rzeon=0,this.act=0,this.rzeoni=0,this.zeona=0,this.zeonp=0,this.acu=!1,this.lock=0,this.zeonToSpend=0,this.mantainZeonToSpend=0,this.spellBook=[],this.readyToCast=[],this.spellMantainList=[],this.loading=!1,this.error=null}}}),E=N("spells",()=>{const o=z([]),e=z([]),l=z([]),t=A(()=>e.value.reduce((i,s)=>i+parseInt(s.spellZeon||0),0)),c=A(()=>l.value.reduce((i,s)=>i+parseInt(s.spellMantain||s.spell_mantain||0),0));async function S(){const i=f();if(i.currentProfileId)try{const s=await h.get(`/api/spells/${i.currentProfileId}`);o.value=s.data}catch(s){throw console.error("Error fetching spell book:",s),s}}async function a(i){const s=f();if(s.currentProfileId)try{const r=await h.post(`/api/spells/${s.currentProfileId}`,i);o.value.push(r.data)}catch(r){throw console.error("Error adding spell:",r),r}}async function v(i){const s=f();if(s.currentProfileId)try{const r=o.value.find(u=>u.spell_name===i);if(r){await h.delete(`/api/spells/${s.currentProfileId}/${r.id}`);const u=o.value.findIndex(_=>_.spell_name===i);u!==-1&&o.value.splice(u,1)}}catch(r){throw console.error("Error removing spell:",r),r}}async function x(){const i=f();if(i.currentProfileId)try{const s=await h.get(`/api/ready-to-cast/${i.currentProfileId}`);e.value=s.data.map((r,u)=>({id:r.id,spellIndex:u,spellName:r.spell_name,spellZeon:r.spell_zeon,spellMantain:r.spell_mantain||0,spellMantainTurn:r.spell_mantain_turn||!1,spell_id:r.spell_id}))}catch(s){throw console.error("Error fetching ready to cast:",s),s}}async function g(i,s,r=0){const u=f();if(u.currentProfileId)try{const _=o.value.find(w=>w.spell_name===i),M=await h.post(`/api/ready-to-cast/${u.currentProfileId}`,{spell_id:_?_.id:null,spell_name:i,spell_zeon:s,spell_mantain:r||0,spell_index:e.value.length});e.value.push({id:M.data.id,spellIndex:e.value.length,spellName:i,spellZeon:s,spellMantain:r,spellMantainTurn:!1,spell_id:_?_.id:null})}catch(_){throw console.error("Error loading spell:",_),_}}async function k(i,s){const r=f();if(r.currentProfileId)try{const u=e.value.find(_=>_.spellIndex===i);if(u){await h.delete(`/api/ready-to-cast/${r.currentProfileId}/${u.id}`);const _=e.value.findIndex(M=>M.spellIndex===i);_!==-1&&e.value.splice(_,1)}}catch(u){throw console.error("Error unloading spell:",u),u}}async function V(){const i=f();if(i.currentProfileId)try{const s=await h.get(`/api/spell-mantain/${i.currentProfileId}`);l.value=s.data.map((r,u)=>({id:r.id,spell_index:u,spell_name:r.spell_name,spell_mantain:r.spell_mantain,spell_id:r.spell_id}))}catch(s){throw console.error("Error fetching maintained spells:",s),s}}async function B(i){const s=f();if(s.currentProfileId)try{const r=l.value.find(u=>u.spell_index===i);if(r){await h.delete(`/api/spell-mantain/${s.currentProfileId}/${r.id}`);const u=l.value.findIndex(_=>_.spell_index===i);u!==-1&&l.value.splice(u,1)}}catch(r){throw console.error("Error unmantaining spell:",r),r}}async function I(){const i=f(),s=$();if(i.currentProfileId)try{const r=e.value.filter(w=>w.spellMantainTurn===!0);for(const w of r){const G=await h.post(`/api/spell-mantain/${i.currentProfileId}`,{spell_id:w.spell_id,spell_name:w.spellName,spell_mantain:w.spellMantain,spell_index:l.value.length});l.value.push({id:G.data.id,spell_index:l.value.length,spell_name:w.spellName,spell_mantain:w.spellMantain,spell_id:w.spell_id})}let u=parseInt(s.zeona)-parseInt(t.value),_=parseInt(s.rzeon),M=parseInt(s.zeonp);u>=10?(_=_+(u-10),M=M+10,u=0):(_=_+u,u=0),s.zeona=u,s.rzeon=_,s.zeonp=M,await h.delete(`/api/ready-to-cast/${i.currentProfileId}`),e.value=[],await s.saveGameState()}catch(r){throw console.error("Error casting spell:",r),r}}function D(){o.value=[],e.value=[],l.value=[]}return{spellBook:o,readyToCast:e,spellMantainList:l,zeonToSpend:t,mantainZeonToSpend:c,fetchSpellBook:S,addSpell:a,removeSpell:v,fetchReadyToCast:x,loadSpell:g,unloadSpell:k,fetchMaintainedSpells:V,unmantainSpell:B,castSpell:I,resetSpellData:D}}),J={name:"TurnCounter",setup(){const o=$();return{gameState:o,nextTurn:async()=>{await o.nextTurn()},previousTurn:async()=>{await o.previousTurn()}}}},K={class:"card mb-3"},Q={class:"card-body text-center"},X={class:"d-flex justify-content-center align-items-center gap-3"},Y=["disabled"],ee={class:"turn-display"},ne={class:"mb-0"},te={key:0,class:"mt-3 text-muted small"};function oe(o,e,l,t,c,S){return m(),p("div",K,[n("div",Q,[e[5]||(e[5]=n("h6",{class:"text-muted mb-3"},"Turno",-1)),n("div",X,[n("button",{class:"btn btn-outline-secondary",onClick:e[0]||(e[0]=(...a)=>t.previousTurn&&t.previousTurn(...a)),disabled:t.gameState.turn_number===0},[...e[2]||(e[2]=[n("i",{class:"bi bi-arrow-left"},null,-1)])],8,Y),n("div",ee,[n("h1",ne,d(t.gameState.turn_number),1)]),n("button",{class:"btn btn-outline-primary",onClick:e[1]||(e[1]=(...a)=>t.nextTurn&&t.nextTurn(...a))},[...e[3]||(e[3]=[n("i",{class:"bi bi-arrow-right"},null,-1)])])]),t.gameState.rzeoni>0?(m(),p("div",te,[e[4]||(e[4]=n("i",{class:"bi bi-arrow-repeat"},null,-1)),j(" Regeneración: +"+d(t.gameState.rzeoni)+" zeon por turno ",1)])):L("",!0)])])}const ae=T(J,[["render",oe],["__scopeId","data-v-8436d513"]]),le={name:"CharacterStats",setup(){const o=$(),e=z(!1),l=z(o.rzeon),t=z(o.act),c=z(o.rzeoni),S=()=>{l.value=o.rzeon,t.value=o.act,c.value=o.rzeoni};return{gameState:o,isEditing:e,localRzeon:l,localAct:t,localRzeoni:c,toggleEdit:async()=>{e.value?await o.updateCharacteristics({rzeon:l.value,act:t.value,rzeoni:c.value}):S(),e.value=!e.value}}}},se={class:"card mb-3"},re={class:"card-header d-flex justify-content-between align-items-center"},ie={class:"card-body"},de={class:"row g-3"},ce={class:"col-md-6"},ue=["disabled"],pe={class:"col-md-6"},me=["disabled"],he={class:"col-md-6"},_e=["disabled"],fe={class:"col-md-6"},be={class:"input-group"},ve=["value"],ye={class:"input-group-text"},Se={class:"mt-3"},ge={class:"d-flex justify-content-between align-items-center mb-2"},ze={class:"badge bg-info"},we={class:"d-flex justify-content-between align-items-center mb-2"},Te={class:"badge bg-warning"},Me={class:"d-flex justify-content-between align-items-center"},Ce={class:"badge bg-success"};function Ze(o,e,l,t,c,S){return m(),p("div",se,[n("div",re,[e[4]||(e[4]=n("h5",{class:"mb-0"},"Características",-1)),n("button",{class:"btn btn-sm btn-outline-primary",onClick:e[0]||(e[0]=(...a)=>t.toggleEdit&&t.toggleEdit(...a))},d(t.isEditing?"Guardar":"Editar"),1)]),n("div",ie,[n("div",de,[n("div",ce,[e[5]||(e[5]=n("label",{class:"form-label"},"Zeon Máximo (RZeon)",-1)),b(n("input",{type:"number",class:"form-control","onUpdate:modelValue":e[1]||(e[1]=a=>t.localRzeon=a),disabled:!t.isEditing,min:"0"},null,8,ue),[[y,t.localRzeon,void 0,{number:!0}]])]),n("div",pe,[e[6]||(e[6]=n("label",{class:"form-label"},"ACT",-1)),b(n("input",{type:"number",class:"form-control","onUpdate:modelValue":e[2]||(e[2]=a=>t.localAct=a),disabled:!t.isEditing,min:"0"},null,8,me),[[y,t.localAct,void 0,{number:!0}]])]),n("div",he,[e[7]||(e[7]=n("label",{class:"form-label"},"Regeneración Zeónica",-1)),b(n("input",{type:"number",class:"form-control","onUpdate:modelValue":e[3]||(e[3]=a=>t.localRzeoni=a),disabled:!t.isEditing,min:"0"},null,8,_e),[[y,t.localRzeoni,void 0,{number:!0}]])]),n("div",fe,[e[8]||(e[8]=n("label",{class:"form-label"},"Zeon Actual",-1)),n("div",be,[n("input",{type:"number",class:"form-control",value:t.gameState.zeon,readonly:""},null,8,ve),n("span",ye,"/ "+d(t.gameState.rzeon),1)])])]),n("div",Se,[n("div",ge,[e[9]||(e[9]=n("span",{class:"text-muted"},"Zeon Acumulado:",-1)),n("span",ze,d(t.gameState.zeona),1)]),n("div",we,[e[10]||(e[10]=n("span",{class:"text-muted"},"Zeon Perdido:",-1)),n("span",Te,d(t.gameState.zeonp),1)]),n("div",Me,[e[11]||(e[11]=n("span",{class:"text-muted"},"Zeon Disponible:",-1)),n("span",Ce,d(t.gameState.availableZeon),1)])])])])}const xe=T(le,[["render",Ze],["__scopeId","data-v-d1973857"]]),ke={name:"ZeonControl",setup(){const o=$(),e=z(1),l=z(0),t=z(0),c=A(()=>o.rzeon===0?0:Math.min(100,o.zeon/o.rzeon*100)),S=A(()=>{const g=c.value;return g<25?"bg-danger":g<50?"bg-warning":g<75?"bg-info":"bg-success"}),a=A(()=>o.availableZeon<0?"text-danger":"text-success");return{gameState:o,zeonAmount:e,zeonAccumulatedAmount:l,zeonLostAmount:t,zeonPercentage:c,zeonBarClass:S,availableZeonClass:a,modifyZeon:async g=>{g>0?await o.addZeon(g):await o.spendZeon(Math.abs(g))},addZeonAccumulated:async g=>{const k=g==="normal"?l.value:t.value;k>0&&(await o.addZeonAccumulated(k,g),g==="normal"?l.value=0:t.value=0)}}}},Ae={class:"card mb-3"},$e={class:"card-body"},Ee={class:"row g-3"},Ie={class:"col-12"},De={class:"progress",style:{height:"30px"}},Le={class:"col-12"},Ve={class:"input-group"},Be={class:"col-md-6"},Re={class:"input-group"},Ue={class:"mt-1"},Pe={class:"text-muted"},Ne={class:"col-md-6"},je={class:"input-group"},Ge={class:"mt-1"},Fe={class:"text-muted"},He={class:"col-12"},qe={class:"alert alert-info mb-0"},Oe={class:"d-flex justify-content-between"},We={class:"d-flex justify-content-between"},Je={class:"d-flex justify-content-between"};function Ke(o,e,l,t,c,S){return m(),p("div",Ae,[e[16]||(e[16]=n("div",{class:"card-header"},[n("h5",{class:"mb-0"},"Control de Zeon")],-1)),n("div",$e,[n("div",Ee,[n("div",Ie,[e[9]||(e[9]=n("label",{class:"form-label"},"Zeon Actual",-1)),n("div",De,[n("div",{class:R(["progress-bar",t.zeonBarClass]),role:"progressbar",style:F({width:t.zeonPercentage+"%"})},d(t.gameState.zeon)+" / "+d(t.gameState.rzeon),7)])]),n("div",Le,[n("div",Ve,[n("button",{class:"btn btn-outline-danger",onClick:e[0]||(e[0]=a=>t.modifyZeon(-10))}," -10 "),n("button",{class:"btn btn-outline-danger",onClick:e[1]||(e[1]=a=>t.modifyZeon(-1))}," -1 "),b(n("input",{type:"number",class:"form-control text-center","onUpdate:modelValue":e[2]||(e[2]=a=>t.zeonAmount=a),min:"0",placeholder:"Cantidad"},null,512),[[y,t.zeonAmount,void 0,{number:!0}]]),n("button",{class:"btn btn-outline-success",onClick:e[3]||(e[3]=a=>t.modifyZeon(1))}," +1 "),n("button",{class:"btn btn-outline-success",onClick:e[4]||(e[4]=a=>t.modifyZeon(10))}," +10 ")])]),n("div",Be,[e[10]||(e[10]=n("label",{class:"form-label"},"Zeon Acumulado (Normal)",-1)),n("div",Re,[b(n("input",{type:"number",class:"form-control","onUpdate:modelValue":e[5]||(e[5]=a=>t.zeonAccumulatedAmount=a),min:"0"},null,512),[[y,t.zeonAccumulatedAmount,void 0,{number:!0}]]),n("button",{class:"btn btn-outline-primary",onClick:e[6]||(e[6]=a=>t.addZeonAccumulated("normal"))}," Añadir ")]),n("div",Ue,[n("small",Pe,"Actual: "+d(t.gameState.zeona),1)])]),n("div",Ne,[e[11]||(e[11]=n("label",{class:"form-label"},"Zeon Perdido",-1)),n("div",je,[b(n("input",{type:"number",class:"form-control","onUpdate:modelValue":e[7]||(e[7]=a=>t.zeonLostAmount=a),min:"0"},null,512),[[y,t.zeonLostAmount,void 0,{number:!0}]]),n("button",{class:"btn btn-outline-warning",onClick:e[8]||(e[8]=a=>t.addZeonAccumulated("lost"))}," Añadir ")]),n("div",Ge,[n("small",Fe,"Actual: "+d(t.gameState.zeonp),1)])]),n("div",He,[n("div",qe,[n("div",Oe,[e[12]||(e[12]=n("span",null,"Zeon para lanzar:",-1)),n("strong",null,d(t.gameState.zeonToSpend),1)]),n("div",We,[e[13]||(e[13]=n("span",null,"Zeon para mantener:",-1)),n("strong",null,d(t.gameState.mantainZeonToSpend),1)]),e[15]||(e[15]=n("hr",{class:"my-2"},null,-1)),n("div",Je,[e[14]||(e[14]=n("span",null,"Zeon disponible:",-1)),n("strong",{class:R(t.availableZeonClass)},d(t.gameState.availableZeon),3)])])])])])])}const Qe=T(ke,[["render",Ke]]),Xe={name:"SpellForm",setup(){const o=E(),e=z({spell_name:"",spell_via:"",spell_base:0,spell_inter:0,spell_advanced:0,spell_arcane:0,spell_base_mantain:0,spell_inter_mantain:0,spell_advanced_mantain:0,spell_arcane_mantain:0});return{formData:e,handleAddSpell:async()=>{if(!e.value.spell_name||e.value.spell_base===""||e.value.spell_inter===""||e.value.spell_advanced===""||e.value.spell_arcane===""){alert("Rellena todos los campos correctamente.");return}try{await o.addSpell(e.value),e.value={spell_name:"",spell_via:"",spell_base:0,spell_inter:0,spell_advanced:0,spell_arcane:0,spell_base_mantain:0,spell_inter_mantain:0,spell_advanced_mantain:0,spell_arcane_mantain:0}}catch(t){console.error("Error añadiendo hechizo:",t),alert("Error al añadir el hechizo")}}}}},Ye={class:"spell-form-container"},en={class:"form-row"},nn={class:"form-group"},tn={class:"form-group"},on={class:"form-row"},an={class:"form-group"},ln={class:"form-group"},sn={class:"form-group"},rn={class:"form-group"},dn={class:"form-row"},cn={class:"form-group"},un={class:"form-group"},pn={class:"form-group"},mn={class:"form-group"};function hn(o,e,l,t,c,S){return m(),p("div",Ye,[e[22]||(e[22]=n("h3",null,"Añadir Hechizo",-1)),n("form",{onSubmit:e[10]||(e[10]=H((...a)=>t.handleAddSpell&&t.handleAddSpell(...a),["prevent"])),class:"spell-form"},[n("div",en,[n("div",nn,[e[11]||(e[11]=n("label",{for:"spellName"},"Nombre:",-1)),b(n("input",{type:"text",id:"spellName","onUpdate:modelValue":e[0]||(e[0]=a=>t.formData.spell_name=a),placeholder:"Nombre del hechizo",required:""},null,512),[[y,t.formData.spell_name]])]),n("div",tn,[e[12]||(e[12]=n("label",{for:"spellVia"},"Vía:",-1)),b(n("input",{type:"text",id:"spellVia","onUpdate:modelValue":e[1]||(e[1]=a=>t.formData.spell_via=a),placeholder:"Vía mágica"},null,512),[[y,t.formData.spell_via]])])]),n("div",on,[n("div",an,[e[13]||(e[13]=n("label",{for:"spellBase"},"Base:",-1)),b(n("input",{type:"number",id:"spellBase","onUpdate:modelValue":e[2]||(e[2]=a=>t.formData.spell_base=a),placeholder:"0",required:""},null,512),[[y,t.formData.spell_base,void 0,{number:!0}]])]),n("div",ln,[e[14]||(e[14]=n("label",{for:"spellInter"},"Intermedio:",-1)),b(n("input",{type:"number",id:"spellInter","onUpdate:modelValue":e[3]||(e[3]=a=>t.formData.spell_inter=a),placeholder:"0",required:""},null,512),[[y,t.formData.spell_inter,void 0,{number:!0}]])]),n("div",sn,[e[15]||(e[15]=n("label",{for:"spellAdvanced"},"Avanzado:",-1)),b(n("input",{type:"number",id:"spellAdvanced","onUpdate:modelValue":e[4]||(e[4]=a=>t.formData.spell_advanced=a),placeholder:"0",required:""},null,512),[[y,t.formData.spell_advanced,void 0,{number:!0}]])]),n("div",rn,[e[16]||(e[16]=n("label",{for:"spellArcane"},"Arcano:",-1)),b(n("input",{type:"number",id:"spellArcane","onUpdate:modelValue":e[5]||(e[5]=a=>t.formData.spell_arcane=a),placeholder:"0",required:""},null,512),[[y,t.formData.spell_arcane,void 0,{number:!0}]])])]),n("div",dn,[n("div",cn,[e[17]||(e[17]=n("label",{for:"spellBaseMantain"},"Mantener Base:",-1)),b(n("input",{type:"number",id:"spellBaseMantain","onUpdate:modelValue":e[6]||(e[6]=a=>t.formData.spell_base_mantain=a),placeholder:"0"},null,512),[[y,t.formData.spell_base_mantain,void 0,{number:!0}]])]),n("div",un,[e[18]||(e[18]=n("label",{for:"spellInterMantain"},"Mantener Inter:",-1)),b(n("input",{type:"number",id:"spellInterMantain","onUpdate:modelValue":e[7]||(e[7]=a=>t.formData.spell_inter_mantain=a),placeholder:"0"},null,512),[[y,t.formData.spell_inter_mantain,void 0,{number:!0}]])]),n("div",pn,[e[19]||(e[19]=n("label",{for:"spellAdvancedMantain"},"Mantener Avanzado:",-1)),b(n("input",{type:"number",id:"spellAdvancedMantain","onUpdate:modelValue":e[8]||(e[8]=a=>t.formData.spell_advanced_mantain=a),placeholder:"0"},null,512),[[y,t.formData.spell_advanced_mantain,void 0,{number:!0}]])]),n("div",mn,[e[20]||(e[20]=n("label",{for:"spellArcaneMantain"},"Mantener Arcano:",-1)),b(n("input",{type:"number",id:"spellArcaneMantain","onUpdate:modelValue":e[9]||(e[9]=a=>t.formData.spell_arcane_mantain=a),placeholder:"0"},null,512),[[y,t.formData.spell_arcane_mantain,void 0,{number:!0}]])])]),e[21]||(e[21]=n("button",{type:"submit",class:"btn btn-primary"},"Añadir Hechizo",-1))],32)])}const _n=T(Xe,[["render",hn],["__scopeId","data-v-6e07fb49"]]),fn={name:"SpellBook",setup(){const o=E();return{spellsStore:o,handleRemoveSpell:async l=>{if(confirm(`¿Eliminar el hechizo "${l}"?`))try{await o.removeSpell(l)}catch(t){console.error("Error eliminando hechizo:",t),alert("Error al eliminar el hechizo")}}}}},bn={class:"spell-book-container"},vn={key:0,class:"empty-state"},yn={key:1,class:"table-responsive"},Sn={class:"table"},gn=["onClick"];function zn(o,e,l,t,c,S){return m(),p("div",bn,[e[1]||(e[1]=n("h3",null,"Lista de Hechizos",-1)),t.spellsStore.spellBook.length===0?(m(),p("div",vn," No hay hechizos guardados. Añade uno nuevo arriba. ")):(m(),p("div",yn,[n("table",Sn,[e[0]||(e[0]=n("thead",null,[n("tr",null,[n("th",null,"Nombre"),n("th",null,"Vía"),n("th",null,"Base"),n("th",null,"Inter"),n("th",null,"Avanz"),n("th",null,"Arcano"),n("th",null,"Mant Base"),n("th",null,"Mant Inter"),n("th",null,"Mant Avanz"),n("th",null,"Mant Arcano"),n("th",null,"Acciones")])],-1)),n("tbody",null,[(m(!0),p(U,null,P(t.spellsStore.spellBook,a=>(m(),p("tr",{key:a.id},[n("td",null,d(a.spell_name),1),n("td",null,d(a.spell_via||"-"),1),n("td",null,d(a.spell_base),1),n("td",null,d(a.spell_inter),1),n("td",null,d(a.spell_advanced),1),n("td",null,d(a.spell_arcane),1),n("td",null,d(a.spell_base_mantain||0),1),n("td",null,d(a.spell_inter_mantain||0),1),n("td",null,d(a.spell_advanced_mantain||0),1),n("td",null,d(a.spell_arcane_mantain||0),1),n("td",null,[n("button",{onClick:v=>t.handleRemoveSpell(a.spell_name),class:"btn btn-danger btn-sm"}," Eliminar ",8,gn)])]))),128))])])]))])}const wn=T(fn,[["render",zn],["__scopeId","data-v-d483894a"]]),Tn={name:"ReadyToCast",setup(){const o=E(),e=z(""),l=z(0),t=z(0);return{spellsStore:o,loadSpellName:e,loadSpellZeon:l,loadSpellMantain:t,handleLoadSpell:async()=>{if(!e.value||!l.value){alert("Introduce nombre y cantidad de Zeon");return}try{await o.loadSpell(e.value,l.value,t.value),e.value="",l.value=0,t.value=0}catch(v){console.error("Error cargando hechizo:",v),alert("Error al cargar el hechizo")}},handleUnloadSpell:async(v,x)=>{try{await o.unloadSpell(v,x)}catch(g){console.error("Error descargando hechizo:",g),alert("Error al descargar el hechizo")}},handleCastSpell:async()=>{try{await o.castSpell()}catch(v){console.error("Error lanzando hechizos:",v),alert("Error al lanzar los hechizos")}}}}},Mn={class:"ready-to-cast-container"},Cn={class:"load-spell-form"},Zn={class:"form-row"},xn={key:0,class:"empty-state"},kn={key:1,class:"table-responsive"},An={class:"table"},$n=["onUpdate:modelValue","disabled"],En=["onClick"],In={class:"total-zeon"};function Dn(o,e,l,t,c,S){return m(),p("div",Mn,[e[6]||(e[6]=n("h3",null,"Hechizos a Lanzar",-1)),n("div",Cn,[n("div",Zn,[b(n("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=a=>t.loadSpellName=a),placeholder:"Nombre del hechizo",class:"form-control"},null,512),[[y,t.loadSpellName]]),b(n("input",{type:"number","onUpdate:modelValue":e[1]||(e[1]=a=>t.loadSpellZeon=a),placeholder:"Zeon",class:"form-control"},null,512),[[y,t.loadSpellZeon,void 0,{number:!0}]]),b(n("input",{type:"number","onUpdate:modelValue":e[2]||(e[2]=a=>t.loadSpellMantain=a),placeholder:"Mantener",class:"form-control"},null,512),[[y,t.loadSpellMantain,void 0,{number:!0}]]),n("button",{onClick:e[3]||(e[3]=(...a)=>t.handleLoadSpell&&t.handleLoadSpell(...a)),class:"btn btn-success"}," Cargar ")])]),t.spellsStore.readyToCast.length===0?(m(),p("div",xn," No hay hechizos cargados para lanzar. ")):(m(),p("div",kn,[n("table",An,[e[5]||(e[5]=n("thead",null,[n("tr",null,[n("th",null,"Nombre"),n("th",null,"Zeon"),n("th",null,"Mantener"),n("th",null,"Mant. este turno"),n("th",null,"Acciones")])],-1)),n("tbody",null,[(m(!0),p(U,null,P(t.spellsStore.readyToCast,a=>(m(),p("tr",{key:a.spellIndex},[n("td",null,d(a.spellName),1),n("td",null,d(a.spellZeon),1),n("td",null,d(a.spellMantain||0),1),n("td",null,[b(n("input",{type:"checkbox","onUpdate:modelValue":v=>a.spellMantainTurn=v,disabled:!a.spellMantain||a.spellMantain===0},null,8,$n),[[q,a.spellMantainTurn]])]),n("td",null,[n("button",{onClick:v=>t.handleUnloadSpell(a.spellIndex,a.spellZeon),class:"btn btn-warning btn-sm"}," Descargar ",8,En)])]))),128))])]),n("div",In,[n("strong",null,"Zeon Total a Gastar: "+d(t.spellsStore.zeonToSpend),1)]),n("button",{onClick:e[4]||(e[4]=(...a)=>t.handleCastSpell&&t.handleCastSpell(...a)),class:"btn btn-primary btn-cast"}," Lanzar Hechizos ")]))])}const Ln=T(Tn,[["render",Dn],["__scopeId","data-v-a0aee840"]]),Vn={name:"MaintainedSpells",setup(){const o=E();return{spellsStore:o,handleUnmantainSpell:async l=>{if(confirm("¿Dejar de mantener este hechizo?"))try{await o.unmantainSpell(l)}catch(t){console.error("Error eliminando mantenimiento:",t),alert("Error al eliminar el mantenimiento")}}}}},Bn={class:"maintained-spells-container"},Rn={key:0,class:"empty-state"},Un={key:1,class:"table-responsive"},Pn={class:"table"},Nn=["onClick"],jn={class:"total-mantain"};function Gn(o,e,l,t,c,S){return m(),p("div",Bn,[e[1]||(e[1]=n("h3",null,"Hechizos Mantenidos",-1)),t.spellsStore.spellMantainList.length===0?(m(),p("div",Rn," No hay hechizos mantenidos actualmente. ")):(m(),p("div",Un,[n("table",Pn,[e[0]||(e[0]=n("thead",null,[n("tr",null,[n("th",null,"Nombre"),n("th",null,"Coste de Mantenimiento"),n("th",null,"Acciones")])],-1)),n("tbody",null,[(m(!0),p(U,null,P(t.spellsStore.spellMantainList,a=>(m(),p("tr",{key:a.spell_index},[n("td",null,d(a.spell_name||a.spellName),1),n("td",null,d(a.spell_mantain||a.spellMantain),1),n("td",null,[n("button",{onClick:v=>t.handleUnmantainSpell(a.spell_index),class:"btn btn-danger btn-sm"}," Eliminar ",8,Nn)])]))),128))])]),n("div",jn,[n("strong",null,"Zeon Total de Mantenimiento: "+d(t.spellsStore.mantainZeonToSpend),1)])]))])}const Fn=T(Vn,[["render",Gn],["__scopeId","data-v-3d4d622d"]]),Hn={name:"Home",components:{TurnCounter:ae,CharacterStats:xe,ZeonControl:Qe,SpellForm:_n,SpellBook:wn,ReadyToCast:Ln,MaintainedSpells:Fn},setup(){const o=W(),e=f(),l=$(),t=E(),c=z(!1);return O(async()=>{const v=localStorage.getItem("theme");c.value=v==="dark",c.value&&document.body.classList.add("dark-mode"),await l.loadGameData(),await t.fetchSpellBook(),await t.fetchReadyToCast(),await t.fetchMaintainedSpells()}),{authStore:e,gameState:l,isDarkMode:c,toggleTheme:()=>{c.value=!c.value,document.body.classList.toggle("dark-mode"),localStorage.setItem("theme",c.value?"dark":"light")},handleLogout:async()=>{l.resetState(),t.resetSpellData(),e.logout(),o.push("/login")}}}},qn={class:"container-fluid p-4"},On={class:"d-flex justify-content-between align-items-center mb-4"},Wn={class:"text-muted mb-0"},Jn={class:"d-flex gap-2"},Kn={key:0,class:"text-center py-5"},Qn={key:1,class:"alert alert-danger",role:"alert"},Xn={key:2,class:"row"},Yn={class:"col-lg-4"},et={class:"col-lg-4"},nt={class:"col-lg-12"};function tt(o,e,l,t,c,S){var I,D;const a=Z("TurnCounter"),v=Z("CharacterStats"),x=Z("ZeonControl"),g=Z("SpellForm"),k=Z("SpellBook"),V=Z("ReadyToCast"),B=Z("MaintainedSpells");return m(),p("div",qn,[n("div",On,[n("div",null,[e[2]||(e[2]=n("h2",null,"Anima Counter",-1)),n("p",Wn,d((I=t.authStore.user)==null?void 0:I.username)+" - "+d((D=t.authStore.profile)==null?void 0:D.name),1)]),n("div",Jn,[n("button",{class:"btn btn-outline-secondary",onClick:e[0]||(e[0]=(...i)=>t.toggleTheme&&t.toggleTheme(...i)),title:"Cambiar tema"},[n("i",{class:R(t.isDarkMode?"bi bi-sun":"bi bi-moon")},null,2)]),n("button",{class:"btn btn-danger",onClick:e[1]||(e[1]=(...i)=>t.handleLogout&&t.handleLogout(...i))},[...e[3]||(e[3]=[n("i",{class:"bi bi-box-arrow-right"},null,-1),j(" Cerrar Sesión ",-1)])])])]),t.gameState.loading?(m(),p("div",Kn,[...e[4]||(e[4]=[n("div",{class:"spinner-border text-primary",role:"status"},[n("span",{class:"visually-hidden"},"Cargando...")],-1)])])):L("",!0),t.gameState.error?(m(),p("div",Qn,d(t.gameState.error),1)):L("",!0),t.gameState.loading?L("",!0):(m(),p("div",Xn,[n("div",Yn,[C(a),C(v)]),n("div",et,[C(x)]),n("div",nt,[C(g),C(k),C(V),C(B)])]))])}const at=T(Hn,[["render",tt]]);export{at as default};
